<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infinite Shop | Wflo50</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --dark: #0f172a;
            --light-bg: #f8fafc;
            --border: #e2e8f0;
            --success: #16a34a;
            --danger: #ef4444;
        }

        body { 
            margin: 0; 
            font-family: 'Inter', sans-serif; 
            background: #f1f5f9; 
            color: #1e293b; 
        }

        .hero {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            padding: 50px 20px;
            text-align: center;
            border-bottom: 4px solid var(--primary);
        }

        .hero h1 { margin: 0; font-size: 2.5rem; letter-spacing: -1px; }
        .hero p { opacity: 0.8; margin-top: 10px; }

        .container { max-width: 1100px; margin: -30px auto 100px; padding: 0 20px; }

        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); 
            gap: 20px; 
        }

        .card { 
            background: white; 
            border-radius: 12px; 
            border: 1px solid var(--border); 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            transition: 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .card img { width: 64px; height: 64px; object-fit: contain; image-rendering: pixelated; margin-bottom: 15px; }

        .status-badge {
            font-size: 10px;
            text-transform: uppercase;
            font-weight: 800;
            margin-bottom: 10px;
            padding: 2px 8px;
            border-radius: 4px;
        }
        .status-instock { background: #dcfce7; color: #166534; }
        .status-outstock { background: #fee2e2; color: #991b1b; }

        .price-tag { 
            font-size: 13px; font-weight: 700; color: #64748b; 
            margin-bottom: 15px; background: var(--light-bg); 
            padding: 5px 12px; border-radius: 20px;
        }

        .price-val { color: var(--primary); }

        button { 
            width: 100%; padding: 12px; border: none; border-radius: 8px; 
            background: var(--primary); color: white; font-weight: 700; 
            cursor: pointer; transition: 0.2s;
        }
        button:hover { background: var(--primary-dark); }
        button:disabled { background: #cbd5e1; cursor: not-allowed; }

        /* --- FULLSCREEN PANEL OVERRIDES --- */
        .cart-toggle {
            position: fixed; bottom: 20px; right: 20px;
            background: var(--dark); color: white; padding: 15px 25px;
            border-radius: 50px; cursor: pointer; z-index: 1001;
            font-weight: 600; display: flex; align-items: center; gap: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .cart-panel {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 2000;
            display: none; flex-direction: column;
        }
        .cart-panel.active { display: flex; }

        .cart-header { 
            background: var(--dark); color: white; padding: 20px; 
            display: flex; justify-content: space-between; align-items: center; 
            font-size: 1.2rem;
        }
        .cart-body { flex: 1; padding: 20px; overflow-y: auto; background: #f8fafc; }
        
        .cart-item { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; background: white; border-radius: 10px;
            margin-bottom: 10px; border: 1px solid var(--border);
        }

        .remove-btn { color: var(--danger); cursor: pointer; font-weight: bold; font-size: 18px; }

        .total-section { 
            padding: 20px; background: white; border-top: 2px solid var(--border);
            font-size: 16px; font-weight: 800;
        }

        .total-row { display: flex; justify-content: space-between; color: var(--dark); margin-bottom: 5px; }

        .checkout-area { 
            padding: 20px; border-top: 1px solid var(--border); background: white;
            padding-bottom: calc(20px + env(safe-area-inset-bottom));
        }
        
        input { 
            width: 100%; padding: 15px; border: 1px solid var(--border); 
            border-radius: 8px; margin-bottom: 15px; box-sizing: border-box;
            font-size: 16px;
        }

        @media (max-width: 600px) {
            .grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            .hero h1 { font-size: 1.8rem; }
            .cart-toggle { right: 10px; left: 10px; text-align: center; justify-content: center; width: auto; }
        }
    </style>
</head>
<body>

    <div class="hero">
        <h1>Infinite Shop</h1>
        <p>Bestill utstyr til Wflo50 Serveren</p>
    </div>

    <div class="container">
        <div class="grid" id="productGrid"></div>
    </div>

    <div class="cart-toggle" onclick="toggleCart()">
        ð <span id="cartBtnText">Handlekurv (0)</span>
    </div>

    <div id="cartPanel" class="cart-panel">
        <div class="cart-header">
            <strong>Din Handlekurv</strong>
            <span style="font-size: 30px; cursor:pointer" onclick="toggleCart()">â</span>
        </div>
        <div class="cart-body" id="cartItems">
            <p style="text-align:center; color:#64748b; margin-top: 50px;">Kurven er tom</p>
        </div>
        
        <div id="totalSection" class="total-section" style="display:none;"></div>

        <div class="checkout-area">
            <input type="text" id="mcUsername" placeholder="Ditt Minecraft-navn...">
            <button class="btn-checkout" id="checkoutBtn" onclick="sendOrder()" style="background:var(--success); height: 60px; font-size: 18px;">SEND BESTILLING</button>
        </div>
    </div>

<script>
    const WEBHOOK_URL = "https://discord.com/api/webhooks/1467952378144624681/eYXQSuHoHn9MBFcA4FsaANkSjgbJ2ncNoOICyY3uMoxXbYl0mIrqyqvqvimd0eIhAsfO";

    // ALLE DINE 17 PRODUKTER ER BEHOLDT HER
    const products = [
        { id: 1, name: "Diamond Helmet", price: 21, cur: "Iron", img: "https://minecraft.wiki/images/Invicon_Diamond_Helmet.png", stock: true },
        { id: 2, name: "Diamond Chestplate", price: 38, cur: "Iron", img: "https://minecraft.wiki/images/Invicon_Diamond_Chestplate.png", stock: true },
        { id: 3, name: "Diamond Leggings", price: 28, cur: "Iron", img: "https://minecraft.wiki/images/Invicon_Diamond_Leggings.png", stock: true },
        { id: 4, name: "Diamond Boots", price: 16, cur: "Iron", img: "https://minecraft.wiki/images/Invicon_Diamond_Boots.png", stock: true },
        { id: 5, name: "Netherite Upgrade Smithing Template", price: 108, cur: "Diamonds", img: "https://minecraft.wiki/images/Invicon_Netherite_Upgrade.png?b03be", stock: true },
        { id: 6, name: "Totem of Undying", price: 48, cur: "Diamonds", img: "https://minecraft.wiki/images/Invicon_Totem_of_Undying.png", stock: false },
        { id: 7, name: "Netherite Ingot", price: 70, cur: "Diamonds", img: "https://minecraft.wiki/images/Invicon_Netherite_Ingot.png", stock: true, max: 2 },
        { id: 8, name: "Iron Sword", price: 32, cur: "Coal", img: "https://minecraft.wiki/images/Invicon_Iron_Sword.png", stock: true },
        { id: 9, name: "Diamond Sword", price: 45, cur: "Iron", img: "https://minecraft.wiki/images/Invicon_Diamond_Sword.png", stock: true },
        { id: 10, name: "Mystery Box", price: 50, cur: "Iron", img: "https://raw.githubusercontent.com/mathworkproject/image/refs/heads/main/Chest.png", stock: true, max: 1 },
        { id: 11, name: "Diamond Pickaxe", price: 45, cur: "Iron", img: "https://minecraft.wiki/images/Invicon_Diamond_Pickaxe.png", stock: true },
        { id: 12, name: "Iron Pickaxe", price: 25, cur: "Coal", img: "https://minecraft.wiki/images/Invicon_Iron_Pickaxe.png", stock: true },
        { id: 13, name: "Diamond Axe", price: 38, cur: "Iron", img: "https://minecraft.wiki/images/Invicon_Diamond_Axe.png", stock: true },
        { id: 14, name: "Iron Axe", price: 17, cur: "Coal", img: "https://minecraft.wiki/images/Invicon_Iron_Axe.png", stock: true },
        { id: 15, name: "Potato", price: 1, cur: "Coal", img: "https://minecraft.wiki/images/Invicon_Potato.png", stock: true },
        { id: 16, name: "Carrots", price: 1, cur: "Coal", img: "https://minecraft.wiki/images/Invicon_Carrot.png", stock: true },
        { id: 17, name: "Cooked Mutton", price: 3, cur: "Coal", img: "https://minecraft.wiki/images/Invicon_Cooked_Mutton.png", stock: true },
    ];

    let cart = JSON.parse(localStorage.getItem('infShopCart')) || {};

    function renderProducts() {
        const grid = document.getElementById('productGrid');
        grid.innerHTML = products.map(p => `
            <div class="card">
                <div class="status-badge ${p.stock ? 'status-instock' : 'status-outstock'}">
                    ${p.stock ? 'PÃ¥ lager' : 'Utsolgt'}
                </div>
                <img src="${p.img}" alt="${p.name}">
                <h3 style="font-size: 1rem; text-align: center; margin: 10px 0;">${p.name} ${p.max ? `<br><small>(Maks ${p.max})</small>` : ''}</h3>
                <div class="price-tag">Pris: <span class="price-val">${p.price} ${p.cur}</span></div>
                <button ${!p.stock ? 'disabled' : ''} onclick="addToCart(${p.id})">
                    ${p.stock ? 'Legg i kurv' : 'Utsolgt'}
                </button>
            </div>
        `).join('');
    }

    function toggleCart() {
        const panel = document.getElementById('cartPanel');
        panel.classList.toggle('active');
        document.body.style.overflow = panel.classList.contains('active') ? 'hidden' : 'auto';
    }

    function addToCart(id) {
        const p = products.find(x => x.id === id);
        if (p.max && (cart[id] || 0) >= p.max) {
            alert(`Begrensning: Du kan bare kjÃ¸pe ${p.max} stk ${p.name}.`);
            return;
        }
        cart[id] = (cart[id] || 0) + 1;
        saveCart();
    }

    function removeFromCart(id) {
        delete cart[id];
        saveCart();
    }

    function saveCart() {
        localStorage.setItem('infShopCart', JSON.stringify(cart));
        updateCartUI();
    }

    function updateCartUI() {
        const container = document.getElementById('cartItems');
        const totalSection = document.getElementById('totalSection');
        const keys = Object.keys(cart).filter(k => cart[k] > 0);
        
        let count = 0;
        let totals = {};

        if (keys.length === 0) {
            container.innerHTML = '<p style="text-align:center; color:#64748b; margin-top:50px;">Kurven er tom</p>';
            totalSection.style.display = 'none';
        } else {
            totalSection.style.display = 'block';
            container.innerHTML = keys.map(id => {
                const p = products.find(x => x.id == id);
                if (!p) return '';
                const qty = cart[id];
                const linePrice = qty * p.price;
                
                count += qty;
                totals[p.cur] = (totals[p.cur] || 0) + linePrice;

                return `
                    <div class="cart-item">
                        <span><strong>${qty}x</strong> ${p.name}</span>
                        <span>${linePrice} ${p.cur} <span class="remove-btn" onclick="removeFromCart(${id})">â</span></span>
                    </div>
                `;
            }).join('');

            totalSection.innerHTML = Object.keys(totals).map(cur => `
                <div class="total-row"><span>Total ${cur}:</span> <span>${totals[cur]}</span></div>
            `).join('');
        }

        document.getElementById('cartBtnText').innerText = `Handlekurv (${count})`;
    }

    async function sendOrder() {
        const user = document.getElementById('mcUsername').value.trim();
        const keys = Object.keys(cart).filter(k => cart[k] > 0);

        if (!user) return alert("Vennligst skriv inn Minecraft-navnet ditt!");
        if (keys.length === 0) return alert("Handlekurven er tom!");

        const btn = document.getElementById('checkoutBtn');
        btn.disabled = true;
        btn.innerText = "Sender...";

        let totals = {};
        const itemsList = keys.map(id => {
            const p = products.find(x => x.id == id);
            totals[p.cur] = (totals[p.cur] || 0) + (cart[id] * p.price);
            return `â¢ ${cart[id]}x **${p.name}** (${cart[id] * p.price} ${p.cur})`;
        }).join("\n");

        const totalString = Object.keys(totals).map(cur => `${cur}: **${totals[cur]}**`).join("\n");

        const payload = {
            embeds: [{
                title: "ð Ny Bestilling!",
                color: 23295,
                fields: [
                    { name: "Spiller", value: `\`${user}\``, inline: true },
                    { name: "Total betaling", value: totalString, inline: true },
                    { name: "Varer", value: itemsList }
                ],
                footer: { text: "Infinite Shop System" },
                timestamp: new Date()
            }]
        };

        try {
            const res = await fetch(WEBHOOK_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });

            if (res.ok) {
                alert("Takk! For bestillingen. Kontakt infinite.py pÃ¥ discord for oppdateringer");
                cart = {};
                saveCart();
                document.getElementById('mcUsername').value = "";
                if (document.getElementById('cartPanel').classList.contains('active')) toggleCart();
            } else { 
                throw new Error("Feil ved sending"); 
            }
        } catch (e) {
            alert("Kunne ikke sende bestilling. Sjekk internett.");
        } finally {
            btn.disabled = false;
            btn.innerText = "Send Bestilling";
        }
    }

    renderProducts();
    updateCartUI();
</script>
</body>
</html>
